(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"./src/WatchBounds.tsx":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=n.n(r),o=n("./node_modules/react/index.js"),i={updateWatchedBounds:function(){},watchedBounds:new Map},s=o.createContext(i),c=function(e){var t=new Map,n=o.useState(t),r=a()(n,2),i=r[0],c=r[1],u={offset:{left:0,right:0,top:0,bottom:0}},l={watchedBounds:i,updateWatchedBounds:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u;c((function(r){var a=new Map(r);return a.set(e,{ref:t,opts:n}),a}))}};return o.createElement(s.Provider,{value:l},e.children)},u=function(e){var t=e.children,n=e.className,r=e.name,a=e.type,i=e.offset,c=o.useContext(s).updateWatchedBounds,u=o.useRef(null);return o.useEffect((function(){c&&c(r,u,{type:a,offset:i})}),[]),o.createElement("div",{className:n,ref:u},t)}},"./src/components/post/PostBodyParagraph.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(s),u=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(u),p=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(p),h=n("./node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=n.n(g),b=n("./node_modules/graphql-tag/src/index.js"),y=n.n(b),x=n("./node_modules/react/index.js"),v=n("./src/WatchBounds.tsx"),S=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),E=n.n(S),w=n("./node_modules/react-redux/es/index.js"),O=n("./src/components/collection/theming/customStyleSheet.ts"),_=n("./src/components/post/markups/Markups.tsx"),P=n("./src/components/post/paragraph/IframeParagraph/iframePostMessageNormalizer.ts"),j=n("./src/components/session/useFlag.tsx"),T=n("./src/components/ui/AspectRatioPlaceholder.tsx"),k=n("./src/components/ui/FigCaption.tsx"),I=n("./src/components/ui/Figure.tsx"),C=n("./node_modules/@babel/runtime/helpers/extends.js"),N=n.n(C),R=n("./src/framework/style/index.ts"),B=n("./src/framework/track/index.ts"),L=n("./src/framework/track/IntersectionPresenter.tsx"),W=n("./src/styles/position.ts"),M=function(e){return{backgroundColor:e.baseColor.background.normal}},A=function(e){return{width:"1px",minWidth:"100%","*width":"100%"}};var F=Object(w.c)((function(e){return{isAmp:e.config.isAmp}}))((function(e){var t=e.src,n=e.title,r=e.height,a=e.width,o=e.allowFullScreen,i=e.frameBorder,s=e.thumbnailUrl,c=e.rules,u=e.placeholderRef,l=e.iframeRef,p=e.isAmp,d=Object(R.useCx)(),h={src:t,allowFullScreen:o,frameBorder:i,height:r,width:a},m=x.useState(!1),g=E()(m,2),f=g[0],b=g[1],y=x.useState(!1),v=E()(y,2),S=v[0],w=v[1];if(S||B.a.on("load",(function(){return w(!0)})),l&&l.current&&l.current.parentElement.offsetWidth<l.current.offsetWidth&&!f&&b(!0),p){var O,_={allowFullScreen:o};for(var P in _)h[P]=h[P]?"":null;return O=s?x.createElement("amp-img",{placeholder:"",src:s,layout:"fill"}):x.createElement("div",{placeholder:"",className:d([W.a,M])}),x.createElement("amp-iframe",N()({},h,{class:d(c),placeholder:"",resizable:"",layout:"responsive",sandbox:"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"}),O,x.createElement("div",{overflow:"true",tabIndex:"0",role:"button","aria-label":"Read more"},"Read more"))}return S?x.createElement(L.a,{ref:u,rootMargin:"200px 0px"},(function(e){return e?x.createElement("iframe",N()({},h,{ref:l,title:n,className:d(f?[c,A]:c),scrolling:f?"no":"auto"})):null})):null})),H=n("./src/styles/breakpoints.ts"),z=n("./src/styles/post/spacing.ts"),G=n("./src/util/richText.ts"),U=n("./src/util/routes.ts");function D(){var e=a()(["\n  fragment IframeParagraph_customStyleSheet on CustomStyleSheet {\n    id\n    postBodyIframe {\n      ...SupportedContainerStyles_styleNode\n    }\n  }\n  ","\n"]);return D=function(){return e},e}function Y(){var e=a()(["\n  fragment IframeParagraph_paragraph on Paragraph {\n    iframe {\n      mediaResource {\n        id\n        iframeSrc\n        iframeHeight\n        iframeWidth\n        title\n      }\n    }\n    layout\n    ...getEmbedlyCardUrlParams_paragraph\n    ...Markups_paragraph\n  }\n  ","\n  ","\n"]);return Y=function(){return e},e}var q=x.memo((function(e){var t=e.host,n=e.isAmp,r=e.paragraph,a=e.paragraphStyle,o=e.richTextStyle,i=e.spaceTop,s=e.updateWatchedBounds,c=e.customStyleSheet,u=Object(R.useCx)(),l=Object(j.a)("enable_theme_editor"),p=x.useRef(null),d=(r.iframe||{}).mediaResource,h=d||{},m=h.id,g=h.iframeSrc,b=h.iframeHeight,y=h.iframeWidth,v=h.title,S=g;S||(S=m?Object(U.db)(t,m):"");var w=function(e){var t=e.src,n=e.initialHeight,r=e.initialWidth,a=x.useRef(null),o=x.useState(n),i=E()(o,2),s=i[0],c=i[1],u=x.useState(r),l=E()(u,2),p=l[0],d=l[1];return x.useEffect((function(){if(""!==t){var e=Object(P.a)((function(e){"iframe.resize"===e.context&&e.src===t&&e.height>0&&(a.current&&d(a.current.offsetWidth),c(e.height))})).destructor;return function(){e()}}}),[t,n]),[s,p,a]}({src:S,initialHeight:b||0,initialWidth:y||0}),C=E()(w,3),N=C[0],B=C[1],L=C[2],M=x.useRef(null);if(x.useEffect((function(){if(s&&d&&d.id&&B&&N){var e="";p.current&&(e=p.current.offsetTop.toString()),s("".concat(d.id,"-").concat(e),p,{type:"image"})}}),[]),!S)return null;var A=r.text?x.createElement(k.a,null,x.createElement(_.a,{paragraph:r,paragraphStyle:a,richTextStyle:o})):null,D=[Object(z.m)(i)];D.push((function(e){return{clear:"both"}})),"OUTSET_LEFT"===(r.layout||void 0)&&"STREAM"!==o&&D.push((function(e){var t;return t={background:e.backgroundColor,borderWidth:e.borderWidthThick+"px",borderStyle:e.borderStyle,borderColor:e.backgroundColor,float:"left",marginLeft:"-150px",marginRight:"30px",width:"75%",padding:"0",paddingBottom:"10px"},f()(t,H.md(e),{float:"none",marginLeft:"0",marginRight:"0",width:"100%"}),f()(t,"marginBottom","16px"),t})),l&&D.push(function(e){return Object(O.i)(null==e?void 0:e.postBodyIframe)}(c));var Y=n?Object(G.b)(r):null;return x.createElement(I.a,{className:u(D),figCaption:A,figureRef:p},Y?x.createElement(x.Fragment,null,x.createElement("amp-embedly-card",{"data-url":Y.url,layout:"responsive",width:B,height:N,"data-card-controls":"0"})):x.createElement(T.a,{height:N,width:B,backgroundColor:"NONE",ref:M},x.createElement(F,{placeholderRef:M,iframeRef:L,src:S,title:v||"",height:N,width:B,allowFullScreen:!0,frameBorder:"0",rules:W.a})))})),Q=Object(w.c)((function(e){return{isAmp:e.config.isAmp,host:e.navigation.host}}))(q),X=y()(Y(),G.c,_.c),V=y()(D(),O.b),J=Q,K=n("./src/components/post/paragraph/ImageParagraph.tsx"),Z=n("./src/components/post/paragraph/MixtapeParagraph.tsx"),$=n("./src/components/post/paragraph/TextParagraph.tsx");function ee(){var e=a()(["\n      fragment PostBodyParagraph_paragraph on Paragraph {\n        name\n        type\n        ...ImageParagraph_paragraph\n        ...TextParagraph_paragraph\n        ...IframeParagraph_paragraph\n        ...MixtapeParagraph_paragraph\n      }\n      ","\n      ","\n      ","\n      ","\n    "]);return ee=function(){return e},e}function te(){var e=a()(["\n  fragment PostBodyParagraph_customStyleSheet on CustomStyleSheet {\n    ...IframeParagraph_customStyleSheet\n    ...ImageParagraph_customStyleSheet\n    ...TextParagraph_customStyleSheet\n  }\n  ","\n  ","\n  ","\n"]);return te=function(){return e},e}function ne(){var e=a()(["\n  fragment PostBodyParagraph_privateNote on Note {\n    ...TextParagraph_privateNote\n    ...ImageParagraph_privateNote\n  }\n  ","\n  ","\n"]);return ne=function(){return e},e}function re(){var e=a()(["\n  fragment PostBodyParagraph_highlight on Quote {\n    ...TextParagraph_highlight\n    ...ImageParagraph_highlight\n  }\n  ","\n  ","\n"]);return re=function(){return e},e}n.d(t,"b",(function(){return oe})),n.d(t,"c",(function(){return ie})),n.d(t,"a",(function(){return se}));var ae=function(e){function t(){return i()(this,t),l()(this,d()(t).apply(this,arguments))}return m()(t,e),c()(t,[{key:"render",value:function(){var e,t=this.props,n=t.paragraph,r=t.paragraphStyle,a=t.richTextStyle,o=t.sequenceAspectRatio,i=t.spaceTop,s=t.insert,c=t.highlights,u=t.privateNotes,l=t.customStyleSheet;switch(n.type){case"IMG":e=x.createElement(v.b.Consumer,null,(function(e){var t=e.updateWatchedBounds;return x.createElement(K.e,{paragraph:n,paragraphStyle:r,richTextStyle:a,sequenceAspectRatio:o,spaceTop:i,updateWatchedBounds:t,highlights:c,privateNotes:u,customStyleSheet:l})}));break;case"P":case"BQ":case"PQ":case"H1":case"H2":case"H3":case"H4":case"ULI":case"OLI":case"PRE":e=x.createElement($.f,{paragraph:n,paragraphStyle:r,richTextStyle:a,spaceTop:i,highlights:c,privateNotes:u,customStyleSheet:l});break;case"IFRAME":e=x.createElement(v.b.Consumer,null,(function(e){var t=e.updateWatchedBounds;return x.createElement(J,{paragraph:n,paragraphStyle:r,richTextStyle:a,spaceTop:i,updateWatchedBounds:t,customStyleSheet:l})}));break;case"MIXTAPE_EMBED":e=x.createElement(Z.a,{paragraph:n,paragraphStyle:r,richTextStyle:a,spaceTop:i});break;default:e=null}return s?x.createElement(x.Fragment,null,"before"===s.order&&s.component,e,"after"===s.order&&s.component):e}}]),t}(x.Component);f()(ae,"fragments",{paragraph:y()(ee(),X,K.c,$.f.fragments.paragraph,Z.a.fragments.paragraph)});t.d=ae;var oe=y()(re(),$.c,K.b),ie=y()(ne(),$.d,K.d),se=y()(te(),V,K.a,$.b)},"./src/components/post/PostBodySection.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(s),u=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(u),p=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(p),h=n("./node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=n.n(g),b=n("./node_modules/graphql-tag/src/index.js"),y=n.n(b),x=n("./node_modules/react/index.js"),v=n("./src/WatchBounds.tsx"),S=n("./src/components/post/EmbeddedPostContext.tsx"),E=n("./src/components/post/PostBodyParagraph.tsx"),w=n("./src/components/post/grouping/ParagraphLayoutGrouping.tsx"),O=n("./src/framework/design-system/components/index.ts"),_=n("./src/framework/style/index.ts"),P={":after":{display:"block",content:'""',clear:"both"}},j=n("./src/util/miroImage.ts"),T=n("./src/util/theme.ts");function k(){var e=a()(["\n      fragment PostBodySection_paragraphs on Paragraph {\n        name\n        ...PostBodyParagraph_paragraph\n      }\n      ","\n    "]);return k=function(){return e},e}function I(){var e=a()(["\n  fragment PostBodySection_customStyleSheet on CustomStyleSheet {\n    ...ParagraphLayoutGrouping_customStyleSheet\n  }\n  ","\n"]);return I=function(){return e},e}function C(){var e=a()(["\n  fragment PostBodySection_privateNote on Note {\n    ...ParagraphLayoutGrouping_privateNote\n  }\n  ","\n"]);return C=function(){return e},e}function N(){var e=a()(["\n  fragment PostBodySection_highlight on Quote {\n    ...ParagraphLayoutGrouping_highlight\n  }\n  ","\n"]);return N=function(){return e},e}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"b",(function(){return A})),n.d(t,"c",(function(){return F})),n.d(t,"a",(function(){return H}));var L=function(){return{display:"table-cell",paddingBottom:"32px",verticalAlign:"bottom"}};function W(e){var t,n,r,a,o=e.bgImage,i=e.children,s=e.isFullPage,c=e.paragraphName,u=Object(_.useCx)();return o&&o.id&&s?x.createElement(v.a,{name:c,type:"bgimage"},x.createElement("div",{className:u((t=o,n=t.id,r=t.originalWidth,a=t.originalHeight,function(){var e=[400,600,800,1e3,1200,1400,1600,1800,2e3],t={miroId:n,strategy:"RESAMPLE",verticalGradient:{start:29,end:81,opacity:40}},o=e.reduce((function(n,o,i){var s=Object(j.d)(B({},t,{width:o,height:o/r*a}));return i===e.length-1?(n.backgroundImage="url(".concat(s,")"),n):(n["@media (min-width: ".concat(o,"px)")]={backgroundImage:"url(".concat(s,")")},n)}),{});return B({backgroundColor:"rgba(0, 0, 0, 0.9)",backgroundPosition:"50% 50%",backgroundSize:"cover",display:"table",minHeight:"100vh",width:"100%"},o)}))},x.createElement("div",{className:u(L)},x.createElement(O.M,null,(function(e){return x.createElement(O.G,{theme:Object(T.l)(e)},i)}))))):i}var M=function(e){function t(){return i()(this,t),l()(this,d()(t).apply(this,arguments))}return m()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.paragraphViewModels,n=e.postBodyInserts,r=e.section,a=e.customStyleSheet;if(0===t.length)return null;var o=function(e){switch(e){case"SERIES":return{paddingTop:"32px",paddingBottom:"32px",margin:"auto 0",width:"100%"};case"STREAM":case"CARD":case"FULL_PAGE":return{wordBreak:"break-word",wordWrap:"break-word"};default:return{}}}(t[0].richTextStyle),i=Object(w.e)(t);return x.createElement(S.a.Consumer,null,(function(e){return x.createElement(O.K,null,(function(s){return x.createElement("section",{className:s([o,P])},x.createElement(W,{bgImage:r.backgroundImage,isFullPage:"FULL_PAGE"===t[0].richTextStyle,paragraphName:t[0].paragraph.name},i.map((function(t,r){return x.createElement(w.a,{key:r,layoutGroup:t,postBodyInserts:n,customStyleSheet:a,isEmbedded:e})}))))}))}))}}]),t}(x.Component);f()(M,"fragments",{paragraphs:y()(k(),E.d.fragments.paragraph)});t.d=M;var A=y()(N(),w.c),F=y()(C(),w.d),H=y()(I(),w.b)},"./src/components/post/body/PostBody.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/extends.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),c=n.n(s),u=n("./node_modules/graphql-tag/src/index.js"),l=n.n(u),p=n("./node_modules/react/index.js"),d=n("./src/WatchBounds.tsx"),h=n("./src/framework/style/index.ts"),m=n("./src/styles/font.ts"),g={border:"none",marginTop:"30px",textAlign:"center",":before":{content:'"..."',letterSpacing:"0.6em",textIndent:"0.6em",fontStyle:"italic",lineHeight:"1.4"}};function f(){var e=Object(h.useCx)();return p.createElement("hr",{className:e([Object(m.b)({fontSize:28}),g])})}var b=n("./src/components/post/PostBodySection.tsx"),y=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),x=n.n(y),v=n("./node_modules/@babel/runtime/helpers/typeof.js"),S=n.n(v),E=n("./node_modules/pluralize/pluralize.js"),w=n.n(E),O=n("./src/components/user/UserAvatar.tsx"),_=n("./src/framework/design-system/components/index.ts"),P=n("./src/framework/design-system/type/Overline.tsx"),j=n("./src/framework/track/index.ts");function T(){var e=a()(["\n  fragment PostNotesDetails_user on User {\n    id\n    imageId\n    name\n    username\n    ...UserAvatar_user\n  }\n  ","\n"]);return T=function(){return e},e}function k(e){var t=e.grid.xStep;return{padding:"".concat(3*t,"px ").concat(4*t,"px ").concat(3*t,"px"),width:"400px"}}var I=p.memo((function(e){var t=e.close,n=e.users,r=Object(h.useCx)(),a=p.useRef(null),o=Object(h.useTheme)(),i=o.grid.xStep;return p.useEffect((function(){function e(){var e=a.current;if(e&&e.getBoundingClientRect){var n=e.getBoundingClientRect(),r=n.bottom,i=n.top<0||r>window.innerHeight,s=window.innerWidth<o.breakpoints.xl;(i||s)&&t()}}return j.a.on("scroll_end",e),j.a.on("resize_throttled",e),function(){j.a.off("scroll_end",e),j.a.off("resize_throttled",e)}}),[]),p.createElement("section",{ref:a,className:r(k)},p.createElement(_.b,{borderBottom:"BASE_LIGHTER",marginBottom:"-".concat(i,"px"),paddingBottom:"".concat(2*i,"px")},p.createElement(P.a,null,"Highlights (".concat(n.length,")"))),p.createElement(_.b,{marginLeft:"3px"},n.length&&n.map((function(e){return p.createElement(_.b,{display:"inline-block",key:e.id,marginTop:"".concat(5*i,"px"),marginRight:"".concat(5*i,"px"),width:"".concat(8*i,"px")},p.createElement(O.d,{hasPopover:!0,link:!0,user:e,scale:"XS"}))}))))})),C=l()(T(),O.b),N=n("./src/components/post/markups/HighlightSegmentsContext.tsx"),R=n("./src/components/post/notes/PostAnnotationsPopover.tsx"),B=n("./src/components/post/paragraph/IframeParagraph/iframePostMessageNormalizer.ts"),L=n("./src/components/session/WithViewer.tsx"),W=n("./src/framework/design-system/type/Detail.tsx"),M=n("./src/framework/design-system/util/style/converters.ts"),A=n("./src/util/typeGuards.ts");function F(){var e=a()(["\n  fragment PostNotesMarkers_creator on User {\n    id\n    name\n    isFollowing\n  }\n"]);return F=function(){return e},e}function H(){var e=a()(["\n  fragment PostNotesMarkers_highlight on Quote {\n    id\n    endOffset\n    paragraphs {\n      id\n      name\n    }\n    startOffset\n    userId\n    user {\n      id\n      name\n      ...PostNotesDetails_user\n    }\n  }\n  ","\n"]);return H=function(){return e},e}function z(){return{border:"none",cursor:"pointer",display:"block",padding:"0px",textAlign:"left",width:"100%"}}function G(){return{left:"100%",position:"absolute",top:0}}function U(e,t){return{marginTop:"6px",maxWidth:"100%",position:"absolute",top:"".concat(e-(t||0),"px"),whiteSpace:"nowrap",width:"100%"}}function D(e){return{marginLeft:"auto",marginRight:"auto",maxWidth:"".concat(Object(M.a)(e,8,!0),"px"),position:"relative"}}function Y(){return{display:"inline-block",maxWidth:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}function q(e,t){return"number"==typeof e.startOffset&&"number"==typeof t.startOffset?e.startOffset<t.startOffset?-1:1:-1}function Q(e,t){var n=t.startOffset,r=t.endOffset,a=t.paragraphs[0].name;if(!a||"number"!=typeof n||"number"!=typeof r)return e;var o=!1,i=e[a]||[];return i.length&&(i=i.map((function(e){var a=n<=e.endOffset+1,i=e.startOffset,s=e.endOffset;return a&&(o=!0,e.highlights.push(t),s=Math.max(r,e.endOffset),i=Math.min(n,e.startOffset)),{highlights:e.highlights,endOffset:s,startOffset:i}}))),o||i.push({highlights:[t],endOffset:r,startOffset:n}),e[a]=i,e}function X(e,t,n){var r=new Map;if(e.size&&t.length){var a=function(e){var t=c()(e).sort(q).reduce(Q,{});return Object.values(t).reduce((function(e,t){return t&&"object"===S()(t)&&t.length?(e.push.apply(e,c()(t)),e):e}),[])}(t),o=[];a.forEach((function(t){var a=t.highlights[0],i=a.paragraphs[0].name;if(a&&"number"==typeof a.startOffset&&i){var s=e.get("".concat(i,"_").concat(a.startOffset));if(s&&s.ref&&s.ref.current){var c,u=s.ref.current.getBoundingClientRect().top+window.pageYOffset;o.length&&(c=o.find((function(e){return u<e+n.newFonts.body.lineHeight.M&&u>e||u>e-n.newFonts.body.lineHeight.M&&u<e})));var l=c||u,p=r.get(l)||[];p.length||o.push(l);var d=p.concat(t.highlights);d.length&&r.set(l,d)}}}))}return r}function V(e){var t=e.children,n=e.highlightString,r=e.toggle,a=Object(h.useCx)();return"Top highlight"===n?p.createElement(p.Fragment,null,t):p.createElement("button",{className:a(z),onClick:function(){return r()},onMouseDown:function(e){return e.preventDefault()}},t)}function J(e){var t=e.creator,n=e.positionMap,r=e.yPosOffset,a=Object(h.useCx)();if("number"!=typeof r)return null;var o=Array.from(n.entries());return p.createElement(L.b,{nonBlocking:!0},(function(e){return p.createElement(p.Fragment,null,o.map((function(n,o){var i=x()(n,2),s=i[0],c=i[1],u=function(e,t,n){if(1===e.length){if("anon"===e[0].userId)return"Top highlight";if(!t)return null;if(n&&n.id===e[0].userId&&t.id!==n.id&&!n.isFollowing)return null;if(t&&t.id===e[0].userId)return"You highlighted";if(e[0].user&&e[0].user.name)return e[0].user.name}var r=[];if(e.forEach((function(e){if(e.user){var a=t&&t.id===e.userId,o=e.user.name,i=n&&n.id===e.userId&&(!t||t.id!==n.id&&!n.isFollowing);a?r.length&&"You"===r[0]||r.unshift("You"):i||!o||r.includes(o)||r.push(o)}})),!r.length)return"Top highlight";if(1===r.length)return"You"===r[0]?"You highlighted":r[0];if(2===r.length)return"".concat(r[0]," and ").concat(r[1]);var a=r.slice(0,2),o=r.length-a.length;return"".concat(a[0],", ").concat(a[1],", and ").concat(o," ").concat(w()("other",o))}(c,e,t);return u?p.createElement("div",{className:a(U(s,r)),key:o},p.createElement(_.J,null,(function(e){var t=e.isVisible,n=e.hide,r=e.toggle;return p.createElement(p.Fragment,null,p.createElement(V,{toggle:r,highlightString:u},p.createElement(W.a,{scale:"S"},p.createElement("span",{className:a(Y)},u))),t&&p.createElement(R.a,{boundariesElement:"window",isVisible:!0,hide:n,placement:"right",popoverRenderFn:function(){var e=new Set,t=c.map((function(t){var n=t.user;return n&&n.id&&!e.has(n.id)?(e.add(n.id),n):null})).filter(A.a);return p.createElement(I,{close:n,users:t})}},p.createElement(p.Fragment,null)))}))):null})))}))}var K=p.forwardRef((function(e,t){var n=e.creator,r=e.highlights,a=p.useContext(N.c).highlightSegments,o=p.useRef(null),i=p.useState(null),s=x()(i,2),c=s[0],u=s[1],l=Object(h.useCx)(),d=Object(h.useTheme)(),m=p.useState(null),g=x()(m,2),f=g[0],b=g[1],y=p.useState(null),v=x()(y,2),S=v[0],E=v[1];return p.useEffect((function(){var e=function(){var e=X(a,r,d);if(u(e),"function"!=typeof t&&(null==t?void 0:t.current)&&E(t.current.offsetTop),null==o?void 0:o.current){var n=o.current.getBoundingClientRect().left,i=window.innerWidth-n-8*d.grid.xStep;b(i)}};j.a.on("resize_throttled",e);var n=Object(B.a)((function(t){"iframe.resize"!==t.context&&"player.js"!==t.context||e()})).destructor;return e(),function(){j.a.off("resize_throttled",e),n()}}),[r,a]),p.createElement("div",{className:l(D)},p.createElement(_.b,{display:"block",xs:{display:"none"},sm:{display:"none"},md:{display:"none"},lg:{display:"none"}},p.createElement("aside",{className:l(G),ref:o,style:{width:f?"".concat(f,"px"):void 0}},c&&p.createElement(J,{creator:n,highlights:r,positionMap:c,yPosOffset:S,width:f}))))})),Z=p.memo(K),$=l()(H(),C),ee=l()(F()),te=n("./src/components/post/body/ActivePrivateNoteContext.tsx"),ne=n("./src/util/richText.ts");function re(){var e=a()(["\n  fragment PostBody_customStyleSheet on CustomStyleSheet {\n    ...PostBodySection_customStyleSheet\n  }\n  ","\n"]);return re=function(){return e},e}function ae(){var e=a()(["\n  fragment PostBody_privateNote on Note {\n    ...normalizedBodyModel_privateNote\n    ...PostBodySection_privateNote\n  }\n  ","\n  ","\n"]);return ae=function(){return e},e}function oe(){var e=a()(["\n  fragment PostBody_creator on User {\n    ...PostNotesMarkers_creator\n  }\n  ","\n"]);return oe=function(){return e},e}function ie(){var e=a()(["\n  fragment PostBody_highlight on Quote {\n    paragraphs {\n      id\n    }\n    ...normalizedBodyModel_highlight\n    ...PostBodySection_highlight\n    ...PostNotesMarkers_highlight\n  }\n  ","\n  ","\n  ","\n"]);return ie=function(){return e},e}function se(){var e=a()(["\n  fragment PostBody_bodyModel on RichText {\n    sections {\n      name\n      startIndex\n      textLayout\n      imageLayout\n      backgroundImage {\n        id\n        originalHeight\n        originalWidth\n      }\n      videoLayout\n      backgroundVideo {\n        videoId\n        originalHeight\n        originalWidth\n        previewImageId\n      }\n    }\n    paragraphs {\n      id\n      ...PostBodySection_paragraphs\n    }\n    ...normalizedBodyModel_richText\n  }\n  ","\n  ","\n"]);return se=function(){return e},e}n.d(t,"a",(function(){return le})),n.d(t,"d",(function(){return pe})),n.d(t,"b",(function(){return de})),n.d(t,"e",(function(){return he})),n.d(t,"c",(function(){return me}));var ce=function(){return{position:"absolute",left:0,top:"calc(100vh + ".concat(100,"px)"),bottom:"calc(100vh + ".concat(100,"px)"),width:"10px",pointerEvents:"none"}},ue=p.forwardRef((function(e,t){var n=e.bodyModel,r=e.creator,a=e.highlights,o=e.privateNotes,s=e.postBodyInserts,u=e.richTextStyle,l=void 0===u?"FULL_PAGE":u,m=e.customStyleSheet,g=Object(h.useCx)(),y=Object(te.b)().privateNoteSelection,x=p.useMemo((function(){return a&&y?[].concat(c()(a),[y]):a}),[a,y]),v=p.useMemo((function(){return Object(ne.f)(n,{highlights:x,privateNotes:o,richTextStyle:l})}),[n,x,o,l]),S=s&&s.first;return p.createElement("div",{ref:t},p.createElement(p.Fragment,null,p.createElement(d.a,{name:"ghost-track",type:"ghost",className:g(ce)}),"FULL_PAGE"===l&&a&&a.length>0&&p.createElement(Z,{creator:r,highlights:c()(a),ref:t}),!!S&&p.createElement("section",{className:g({marginBottom:"20px"})},S.component)),v.map((function(e,t){if("HR"===e){var n,r,a=v[t-1],o=v[t+1],c="HR"!==a&&(null==a||null===(n=a.section)||void 0===n?void 0:n.backgroundImage),u="HR"!==o&&(null==o||null===(r=o.section)||void 0===r?void 0:r.backgroundImage);return c||u?null:p.createElement(f,{key:t})}return p.createElement(b.d,i()({key:e.section.name||t,postBodyInserts:s,customStyleSheet:m},e))})))})),le=(t.f=ue,l()(se(),ne.i,b.d.fragments.paragraphs)),pe=l()(ie(),ne.g,b.b,$),de=l()(oe(),ee),he=l()(ae(),ne.h,b.c),me=l()(re(),b.a)},"./src/components/post/grouping/ParagraphLayoutGrouping.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),c=n.n(s),u=n("./node_modules/graphql-tag/src/index.js"),l=n.n(u),p=n("./node_modules/react/index.js"),d=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),h=n.n(d),m=n("./node_modules/@babel/runtime/helpers/extends.js"),g=n.n(m),f=n("./src/WatchBounds.tsx"),b=n("./src/components/collection/theming/customStyleSheet.ts"),y=n("./src/components/post/EmbeddedPostContext.tsx"),x=n("./src/components/post/PostBodyParagraph.tsx"),v=n("./src/components/post/paragraph/TextParagraph.tsx"),S=n("./src/components/session/WithFlag.tsx"),E=n("./src/framework/design-system/util/style/responsiveStyles.ts"),w=n("./src/framework/style/index.ts"),O=n("./src/util/richText.ts");function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(){var e=i()(["\n  fragment ParagraphStyleGrouping_customStyleSheet on CustomStyleSheet {\n    id\n    postBodyOLI {\n      ...SupportedContainerStyles_styleNode\n    }\n    postBodyULI {\n      ...SupportedContainerStyles_styleNode\n    }\n    ...PostBodyParagraph_customStyleSheet\n  }\n  ","\n  ","\n"]);return j=function(){return e},e}function T(){var e=i()(["\n  fragment ParagraphStyleGrouping_privateNote on Note {\n    ...PostBodyParagraph_privateNote\n  }\n  ","\n"]);return T=function(){return e},e}function k(){var e=i()(["\n  fragment ParagraphStyleGrouping_highlight on Quote {\n    ...PostBodyParagraph_highlight\n  }\n  ","\n"]);return k=function(){return e},e}var I=p.memo((function(e){var t=e.styleGroup,n=e.postBodyInserts,r=e.customStyleSheet,o=Object(w.useCx)(),i=A(t),s=t.paragraphViewModels.map((function(e){var t=e.paragraph.name,a=n&&n[t],o=p.createElement(x.d,g()({key:e.paragraph.name,insert:a,customStyleSheet:r},e));return"Title"===e.paragraphStyle?p.createElement(f.a,{name:"title",type:"byline",offset:{left:-600},key:"".concat(e.paragraph.name,"-wb")},o):o}));return i?p.createElement(y.a.Consumer,null,(function(e){return p.createElement(S.a,{name:"enable_theme_editor"},(function(n){return p.createElement(i,{className:o([W({paragraphStyle:t.paragraphStyle,topSpacing:t.topSpacing,paragraphLayout:t.paragraphLayout,paragraphCount:t.paragraphViewModels.length,richTextStyle:t.paragraphViewModels[0].richTextStyle,isEmbedded:e})].concat(a()(n?[M(r,t.paragraphStyle)]:[])))},s)}))})):s})),C=l()(k(),x.b),N=l()(T(),x.c),R=l()(j(),b.b,x.a),B=function(e){var t=[];return e.forEach((function(e){var n=e.paragraphStyle,r=e.paragraph.layout,a=t[t.length-1];a&&L(a,e)?a.paragraphViewModels.push(e):t.push({paragraphStyle:n,paragraphLayout:r,topSpacing:e.sequenceSpaceTop||0,paragraphViewModels:[e]})})),t},L=function(e,t){if(e.paragraphStyle!==t.paragraphStyle)return!1;var n=t.paragraph.layout;return"OUTSET_ROW"===e.paragraphLayout?"OUTSET_ROW_CONTINUE"===n:e.paragraphLayout===n},W=function(e){var t=e.paragraphStyle,n=e.topSpacing,r=e.paragraphLayout,a=(e.paragraphCount,e.richTextStyle),o=e.isEmbedded;return function(e){var i={};switch(n&&(i.marginTop=Object(E.d)((function(e){var t=h()(e,1)[0];return"".concat(t,"px")}),n)),t){case"BQ":var s=e.baseColor.border.darker||"";return Object(E.a)(e,P({},i,{boxShadow:"inset ".concat(3,"px 0 0 0 ").concat(s),paddingLeft:"".concat(23,"px"),marginLeft:Object(O.j)(a)?"0px":"-20px"}));case"PRE":return Object(E.a)(e,P({},i,{padding:"20px",background:e.baseColor.background.normal,overflowX:"auto"}));case"PQ":return Object(E.a)(e,P({},i,{paddingLeft:"SERIES"===a?"0px":"30px"}));case"ULI":if(o)return Object(E.a)(e,v.a)}switch(r){case"OUTSET_ROW":return Object(E.a)(e,P({},i,{display:"flex",flexDirection:"row"}))}return Object(E.a)(e,i)}},M=function(e,t){switch(t){case O.a.OLI:return Object(b.i)(null==e?void 0:e.postBodyOLI);case O.a.ULI:return Object(b.i)(null==e?void 0:e.postBodyULI);default:return function(){return{}}}},A=function(e){var t=e.paragraphStyle,n=e.paragraphLayout;switch(t){case"OLI":return"ol";case"ULI":return"ul";case"BQ":case"PQ":return"blockquote";case"PRE":return"pre"}switch(n){case"OUTSET_ROW":return"div"}return null},F=n("./src/framework/design-system/index.ts"),H=n("./src/schema-types/globalTypes.ts");function z(){var e=i()(["\n  fragment ParagraphLayoutGrouping_customStyleSheet on CustomStyleSheet {\n    ...ParagraphStyleGrouping_customStyleSheet\n  }\n  ","\n"]);return z=function(){return e},e}function G(){var e=i()(["\n  fragment ParagraphLayoutGrouping_privateNote on Note {\n    ...ParagraphStyleGrouping_privateNote\n  }\n  ","\n"]);return G=function(){return e},e}function U(){var e=i()(["\n  fragment ParagraphLayoutGrouping_highlight on Quote {\n    ...ParagraphStyleGrouping_highlight\n  }\n  ","\n"]);return U=function(){return e},e}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}n.d(t,"a",(function(){return X})),n.d(t,"c",(function(){return V})),n.d(t,"d",(function(){return J})),n.d(t,"b",(function(){return K})),n.d(t,"e",(function(){return Z}));var Y={clear:"both"},q={clear:"both",width:"100%"},Q=function(e){var t={boxSizing:"border-box",margin:"0 auto",width:"100%"};return"INSET_CENTER"===e?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{maxWidth:"700px",padding:"0 1.25em"}):t},X=p.memo((function(e){var t=e.layoutGroup,n=e.postBodyInserts,r=e.customStyleSheet,a=e.isEmbedded,o=Object(w.useCx)(),i=t.styleGroups[0].paragraphViewModels[0].richTextStyle,s=t.styleGroups.map((function(e,t){return p.createElement(I,{key:t,styleGroup:e,postBodyInserts:n,customStyleSheet:r})}));if(Object(O.j)(i)||a)return p.createElement(p.Fragment,null,s);switch(t.effectiveLayout){case"OUTSET_CENTER":case"OUTSET_ROW":return p.createElement("div",{className:o(Y)},p.createElement(F.a,{size:{xs:"full",sm:"full",md:"full",lg:"outset",xl:"outset"}},s));case"FULL_WIDTH":return p.createElement("div",{className:o(q)},s);default:return"FULL_PAGE"===i?p.createElement(F.a,{size:"inset"},s):p.createElement("div",{className:o(Q(t.effectiveLayout))},s)}})),V=l()(U(),C),J=l()(G(),N),K=l()(z(),R),Z=function(e){var t=[],n=[];e.forEach((function(e){var r=$(e.paragraphStyle,e.paragraph.layout),o=t[t.length-1];if(o&&o.effectiveLayout===r)n.push(e);else{if(o){var i,s=B(n);(i=o.styleGroups).push.apply(i,a()(s))}n.length=0,n.push(e),t.push({styleGroups:[],effectiveLayout:r})}}));var r=t[t.length-1];if(r){var o,i=B(n);(o=r.styleGroups).push.apply(o,a()(i))}return t},$=function(e,t){switch(t){case H.b.INSET_LEFT:case H.b.OUTSET_LEFT:return"IMG"===e||"IFRAME"===e?H.b.INSET_CENTER:t;case H.b.OUTSET_ROW_CONTINUE:return H.b.OUTSET_ROW;default:return t||H.b.INSET_CENTER}}},"./src/components/post/paragraph/IframeParagraph/iframePostMessageNormalizer.ts":function(e,t,n){"use strict";function r(e){e&&e.iframe&&e.height&&(e.iframe.getAttribute&&"number"==typeof e.height&&i({context:"iframe.resize",height:e.height,src:e.iframe.getAttribute("src")||""}))}function a(e){if(e.data&&"string"==typeof e.data){var t;try{t=JSON.parse(e.data)}catch(e){return}i(t)}}n.d(t,"a",(function(){return s}));var o=[];function i(e){o.forEach((function(t){return t(e)}))}function s(e){return window._resizeIframe||(window._resizeIframe=r,window.addEventListener("message",a)),o.push(e),{destructor:function(){0===(o=o.filter((function(t){return e!==t}))).length&&"undefined"!=typeof window&&(window._resizeIframe=null,window.removeEventListener("message",a))}}}},"./src/components/post/paragraph/ImageParagraph.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/extends.js"),c=n.n(s),u=n("./node_modules/lodash/round.js"),l=n.n(u),p=n("./node_modules/graphql-tag/src/index.js"),d=n.n(p),h=n("./node_modules/react/index.js"),m=n("./src/components/collection/theming/customStyleSheet.ts"),g=n("./src/components/post/body/ParagraphRefsMapContext.tsx"),f=n("./src/components/post/markups/Markups.tsx"),b=n("./src/components/post/notes/PostAnnotationsMarker.tsx"),y=n("./src/components/ui/image/FocusableMiroImage.tsx"),x=n("./src/framework/design-system/components/index.ts"),v=n("./src/framework/style/index.ts"),S=n("./src/util/miroImage.ts"),E=function(e){return{backgroundColor:e.brandColor.sage.light}},w=function(e,t){var n=Object(S.d)({freezeGifs:!1,miroId:e,strategy:S.a.Resample,width:t.breakpoints.sm}),r=Object(S.d)({freezeGifs:!1,miroId:e,strategy:S.a.Resample,width:t.breakpoints.md}),a=Object(S.d)({freezeGifs:!1,miroId:e,strategy:S.a.Resample,width:t.breakpoints.lg}),o=Object(S.d)({freezeGifs:!1,miroId:e,strategy:S.a.Resample,width:t.breakpoints.xl});return{xl:"url('".concat(o,"')"),lg:"url('".concat(o,"')"),md:"url('".concat(a,"')"),sm:"url('".concat(r,"')"),xs:"url('".concat(n,"')")}};function O(e){var t=e.metadata,n=Object(v.useCx)();return h.createElement(x.M,null,(function(e){return h.createElement("div",{className:n(E)},h.createElement(y.a,{backgroundImage:w(t.id,e),miroId:t.id,height:"60vh",width:"100%",minHeight:{xl:500,lg:400,md:400,sm:300,xs:300},imgHeight:500,imgWidth:2e3,focusPercent:null===t.focusPercentX||void 0===t.focusPercentX||null===t.focusPercentY||void 0===t.focusPercentY?void 0:[t.focusPercentX,t.focusPercentY]}))}))}var _=n("./src/components/session/useFlag.tsx"),P=n("./src/components/ui/FigCaption.tsx"),j=n("./src/components/ui/Figure.tsx"),T=n("./src/components/ui/image/index.ts"),k=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),I=n.n(k),C=n("./src/framework/reporter/index.ts"),N=n("./src/framework/track/index.ts"),R=n("./src/styles/zIndex.ts"),B=function(e,t,n,r,a,o,i){if(!i)return{};var s=Math.min(Math.min(t,r||1/0)/o,Math.min(e,n||1/0)/a),c=o*s,u=a*s,l=(e-u)/2,p=((t-c)/2-(i.left+(o-c)/2))/s,d=(l-(i.top+(a-u)/2))/s;return{transition:"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)",zIndex:R.a.floating,transform:"scale(".concat(s,") translate(").concat(p,"px, ").concat(d,"px)"),position:"absolute",height:"".concat(a,"px"),width:"".concat(o,"px"),cursor:"zoom-out"}},L=function(e){var t=e.children,n=e.height,r=e.width,a=e.originalHeight,o=e.originalWidth,i=e.paragraphRef;return e.isLinked||!a||!o||!n||n===a&&r===o?t:h.createElement(W,{originalHeight:a,originalWidth:o,height:n,width:r,paragraphRef:i},t)},W=function(e){var t=e.children,n=e.originalHeight,r=e.originalWidth,a=e.height,o=e.width,i=e.paragraphRef,s=h.useState(null),c=I()(s,2),u=c[0],l=c[1],p=h.useState(0),d=I()(p,2),m=d[0],g=d[1],f=h.useState(0),b=I()(f,2),y=b[0],S=b[1],E=h.useState(0),w=I()(E,2),O=w[0],_=w[1],P=Object(v.useCx)(),j=Object(C.c)(),T=i&&i.current&&i.current.getBoundingClientRect(),k=h.useCallback((function(){j.event("client.action",{action:"zoom",eventType:"click"})}),[]);h.useEffect((function(){g(window.innerHeight),S(window.innerWidth),_(window.scrollY);var e=function(){u&&Math.abs(O-window.scrollY)>40&&l(!1)},t=function(){g(window.innerHeight),S(window.innerWidth)};return N.a.on("scroll",e),N.a.on("resize",t),function(){N.a.off("scroll",e),N.a.off("resize",t)}}));var L;return h.createElement(h.Fragment,null,h.createElement("div",{onClick:function(){u||k(),l(!u)},className:P(u?B(m,y,n,r,a,o,T):(L=u,{transition:"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)",cursor:"zoom-in",position:"relative",zIndex:null===L?"auto":R.a.floating,width:"100%"})),onTransitionEnd:function(){u||l(null)}},t),h.createElement(x.j,{padding:0,withPageScroll:!0,isVisible:!!u,hide:function(){return l(!1)},withCloseButton:!1},h.createElement(h.Fragment,null)))},M=n("./src/styles/breakpoints.ts"),A=n("./src/styles/position.ts"),F=n("./src/styles/post/spacing.ts"),H=n("./src/util/post/image.ts"),z=n("./src/util/richText.ts");function G(){var e=a()(["\n  fragment ImageParagraph_customStyleSheet on CustomStyleSheet {\n    id\n    postBodyImage {\n      ...SupportedContainerStyles_styleNode\n    }\n  }\n  ","\n"]);return G=function(){return e},e}function U(){var e=a()(["\n  fragment ImageParagraph_privateNote on Note {\n    ...PostAnnotationsMarker_privateNote\n  }\n  ","\n"]);return U=function(){return e},e}function D(){var e=a()(["\n  fragment ImageParagraph_highlight on Quote {\n    id\n    ...Markups_highlight\n  }\n  ","\n"]);return D=function(){return e},e}function Y(){var e=a()(["\n  fragment ImageParagraph_paragraph on Paragraph {\n    href\n    layout\n    metadata {\n      id\n      originalHeight\n      originalWidth\n      focusPercentX\n      focusPercentY\n      alt\n    }\n    ...Markups_paragraph\n    ...PostAnnotationsMarker_paragraph\n  }\n  ","\n  ","\n"]);return Y=function(){return e},e}n.d(t,"c",(function(){return q})),n.d(t,"b",(function(){return Q})),n.d(t,"d",(function(){return X})),n.d(t,"a",(function(){return V}));t.e=h.memo((function(e){var t=e.isSequenceCover,n=void 0!==t&&t,r=e.highlights,a=e.paragraph,o=e.paragraphStyle,s=e.privateNotes,u=e.richTextStyle,p=e.sequenceAspectRatio,d=e.spaceTop,y=e.updateWatchedBounds,E=e.customStyleSheet,w=Object(v.useCx)(),k=Object(_.a)("enable_theme_editor"),I=h.useRef(null),C=Object(g.c)(a,o);h.useEffect((function(){if(y){var e=a.name,t=a.metadata&&a.metadata.id;if(e&&t){var n="";I.current&&(n=I.current.offsetTop.toString()),y("".concat(e,"-").concat(t,"-").concat(n),I,{type:"image"})}}}),[]);var N=a.metadata,R=a.layout;if(!N)return null;var B,W=N.id,G=N.originalHeight,U=N.originalWidth,D=N.alt,Y=Object(S.c)(W),q=Object(H.b)({layout:R,originalWidth:U||0,originalHeight:G||0,sequenceAspectRatio:p}),Q=q.width,X=q.height,V=q.strategy,J=q.otherWidths;if("OUTSET_ROW_CONTINUE"===R&&U&&G&&p){var K=U/G;B=l()(p/K,2)}var Z,$=a.text?h.createElement(P.a,{ref:C,textAlign:n?"left":"center",extendLeftRatio:B},s&&h.createElement(b.a,{paragraph:a,privateNotes:s}),h.createElement(f.a,{highlights:r,paragraph:a,paragraphStyle:o,richTextStyle:u})):null;if(n)Z=h.createElement(O,{metadata:{id:W,focusPercentX:N.focusPercentX,focusPercentY:N.focusPercentY}});else{var ee={isAmp:!1,alt:D||void 0,miroId:W,height:X,width:Q,rules:X?[A.a]:[{maxWidth:"100%"}],maxWidth:X?void 0:"100%",strategy:V,freezeGifs:"STREAM"===u||"RESAMPLE"!==V,focusPercentX:N.focusPercentX,focusPercentY:N.focusPercentY,expectedWidth:Q,otherWidths:J};if(Object(z.j)(u)){var te=function(){return h.createElement("div",{className:w(Q>0?{maxWidth:"".concat(Q,"px")}:{})},h.createElement(T.c,ee))};if(!Q||!X)return h.createElement("div",{className:w(Object(F.m)(d))},h.createElement(te,null));Z=h.createElement(te,null)}else if("OUTSET_LEFT"===R||"INSET_LEFT"===R||"INSET_CENTER"===R&&U||"OUTSET_CENTER"===R&&U){var ne=U&&(Y?U/2:U);Z=h.createElement(L,{isLinked:!!a.href,width:ee.width,height:ee.height,originalHeight:N.originalHeight,originalWidth:N.originalWidth,paragraphRef:I},h.createElement("div",{className:w((function(e){return{marginLeft:"auto",marginRight:"auto",maxWidth:"OUTSET_CENTER"===R&&ne&&ne<e.maxWidths.outset?"".concat(e.maxWidths.outset,"px"):"".concat(ne,"px")}}))},h.createElement(T.c,c()({},ee,{height:N.originalHeight||ee.height,width:N.originalWidth||ee.width}))))}else Z=U&&"INSET_CENTER"!==R?h.createElement(L,{isLinked:!!a.href,width:ee.width,height:ee.height,originalHeight:N.originalHeight,originalWidth:N.originalWidth,paragraphRef:I},h.createElement(T.c,c()({},ee,{height:N.originalHeight||ee.height,width:N.originalWidth||ee.width}))):h.createElement(x.b,{display:"flex",justifyContent:"center",sm:{display:"block"}},h.createElement(L,{isLinked:!!a.href,width:ee.width,height:ee.height,originalHeight:N.originalHeight,originalWidth:N.originalWidth,paragraphRef:I},h.createElement(T.c,c()({},ee,{width:null,maxWidth:"100%",strategy:null}))));a.href&&(Z=h.createElement("a",{href:a.href},Z))}var re=[Object(F.m)(d)];if(re.push({clear:"both"}),n)re.push((function(e){return i()({},M.lg(e),{paddingLeft:"0px",paddingRight:"0px"})}));else if(("OUTSET_ROW"===R||"OUTSET_ROW_CONTINUE"===R)&&U&&G&&p){var ae=U/G,oe=l()(ae/p*100,2);re.push({width:"".concat(oe,"%"),marginRight:"10px",paddingTop:"5px",paddingBottom:"5px",":last-of-type":{marginRight:0}})}else"OUTSET_CENTER"===R?re.push({paddingBottom:"5px",paddingTop:"5px"}):"OUTSET_LEFT"===R?re.push((function(e){var t;return t={background:e.backgroundColor,borderWidth:e.borderWidthThick+"px",borderStyle:e.borderStyle,borderColor:e.backgroundColor,float:"left",marginLeft:"-150px",marginRight:"30px",width:"75%",padding:"0",paddingBottom:"10px"},i()(t,M.lg(e),{float:"none",marginLeft:"0",marginRight:"0",width:"100%"}),i()(t,"marginBottom","16px"),t})):"INSET_LEFT"===R?re.push({float:"left",width:"50%",paddingBottom:"10px",paddingRight:"30px",marginBottom:"16px"}):"FULL_WIDTH"===R?re.push({width:"100%"}):"INSET_CENTER"===R&&re.push({marginLeft:"auto",marginRight:"auto"});return k&&re.push(function(e){return Object(m.i)(null==e?void 0:e.postBodyImage)}(E)),h.createElement(j.a,{className:"".concat(w(re)," paragraph-image"),figCaption:$,figureRef:I},Z)}));var q=d()(Y(),f.c,b.b),Q=d()(D(),f.b),X=d()(U(),b.c),V=d()(G(),m.b)},"./src/components/post/paragraph/MixtapeParagraph.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/taggedTemplateLiteral.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=n.n(o),s=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(s),u=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(u),p=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(p),h=n("./node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),g=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),f=n.n(g),b=n("./node_modules/graphql-tag/src/index.js"),y=n.n(b),x=n("./node_modules/react/index.js"),v=n("./src/components/ui/image/FocusableMiroImage.tsx"),S=n("./src/framework/design-system/components/index.ts"),E=n("./src/framework/design-system/type/index.ts"),w=n("./src/styles/post/spacing.ts"),O=n("./src/util/miroImage.ts");function _(){var e=a()(["\n      fragment MixtapeParagraph_paragraph on Paragraph {\n        text\n        type\n        mixtapeMetadata {\n          href\n          thumbnailImageId\n        }\n        markups {\n          start\n          end\n          type\n          href\n        }\n      }\n    "]);return _=function(){return e},e}var P=function(e){return{boxShadow:"inset 0 0 0 1px ".concat(e.baseColor.border.lighter)}},j=function(e){return{boxShadow:"0 1px 4px ".concat(e.baseColor.border.lighter,", ").concat(P(e).boxShadow)}},T=function(e){function t(){return i()(this,t),l()(this,d()(t).apply(this,arguments))}return m()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.paragraph,n=e.spaceTop,r=e.structuredMarkup,a=t.mixtapeMetadata,o=t.type;if(!a||!a.href||!o)return null;var i=a.href,s=r||function(e){var t=e.text,n=e.markups;if(!t)return null;var r=n.find((function(e){return"STRONG"===e.type}));if(!r)return null;var a=n.find((function(e){return"EM"===e.type})),o=r.end,i=a?a.end:r.end;return{title:t.slice(r.start,o).trim(),description:a?t.slice(a.start,a.end).trim():null,domain:t.slice(i).trim()||null}}(t);if(!s)return null;var c=s.title,u=s.description,l=s.domain;return x.createElement(S.K,null,(function(e){return x.createElement("div",{className:e([Object(w.m)(n),j])},x.createElement(S.f,{href:i||"",disableSourceParam:!0,target:"_blank"},x.createElement(S.b,{display:"flex",flexShrink:"0",padding:"0px"},x.createElement(S.b,{padding:"16px 20px",flexShrink:"1",flexGrow:"1",display:"flex",justifyContent:"center",flexDirection:"column",sm:{padding:"10px 12px 10px"}},x.createElement(E.b,{scale:"XS",clamp:2},c),u&&x.createElement(S.b,{marginTop:"8px"},x.createElement(E.f,{scale:"S",clamp:2},u)),l&&x.createElement(S.b,{marginTop:"12px"},x.createElement(E.a,{scale:"S",clamp:2},l))),a&&a.thumbnailImageId&&x.createElement(S.b,{width:"160px"},x.createElement(v.a,{boxShadowRules:P,miroId:a.thumbnailImageId,width:160,height:167,strategy:O.a.Resample,focusPercent:[50,50],imgHeight:167,imgWidth:160})))))}))}}]),t}(x.Component);f()(T,"fragments",{paragraph:y()(_())}),t.a=T},"./src/components/ui/FigCaption.tsx":function(e,t,n){"use strict";var r=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),a=n.n(r),o=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=n.n(o),s=n("./node_modules/react/index.js"),c=n("./src/framework/design-system/util/style/converters.ts"),u=n("./src/framework/style/index.ts"),l=n("./src/styles/breakpoints.ts"),p=n("./src/styles/font.ts"),d=function(e){return function(t){return i()({color:t.baseColor.text.lighter,fontSize:"16px",lineHeight:1.4,marginTop:"10px",textAlign:e,maxWidth:"".concat(Object(c.a)(t,8,!0),"px"),marginLeft:"left"===e?"0":"auto",marginRight:"auto"},l.lg(t),{marginLeft:"auto",textAlign:"center"})}},h=function(e){return function(t){var n=e&&100*e;return{width:"".concat(n,"%"),position:"relative",left:"calc(".concat(100-n/2,"% - 8px)"),transform:"translateX(-50%)"}}},m=s.forwardRef((function(e,t){var n=e.children,r=e.textAlign,o=void 0===r?"center":r,i=e.extendLeftRatio,c=Object(u.useCx)();return s.createElement("figcaption",{className:c([d(o),Object(p.g)()].concat(a()(i?[h(i)]:[]))),ref:t},n)}));t.a=m},"./src/components/ui/Figure.tsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("./node_modules/react/index.js");function a(e){var t=e.children,n=e.figCaption,a=e.className,o=e.figureRef;return r.createElement("figure",{className:a,ref:o},t,n)}},"./src/components/ui/image/FocusableMiroImage.tsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=n.n(r),o=n("./node_modules/react/index.js"),i=n("./src/framework/design-system/util/style/responsiveStyles.ts"),s=n("./src/framework/style/index.ts"),c=n("./src/util/miroImage.ts"),u=function(e){var t=a()(e,1)[0];return"number"==typeof t?"".concat(t,"px"):t},l=function(e){var t=a()(e,1)[0];return"".concat(t[0],"% ").concat(t[1],"%")},p=function(e){return a()(e,1)[0]};function d(e){var t=e.backgroundImage,n=e.boxShadowRules,r=e.miroId,a=e.height,d=e.width,h=e.minHeight,m=e.minWidth,g=e.imgHeight,f=e.imgWidth,b=e.focusPercent,y=e.strategy,x=void 0===y?c.a.Resample:y,v=e.darken,S=e.freezeGifs,E=Object(s.useCx)(),w=t;if(!w){var O=Object(c.d)({miroId:r,height:g,width:f,strategy:x,darken:v,freezeGifs:S});w="url(".concat(O,")")}var _=Object(i.d)(u,a),P=Object(i.d)(u,d),j=h&&Object(i.d)(u,h),T=m&&Object(i.d)(u,m),k=Object(i.d)(l,b),I=Object(i.d)(p,w);return o.createElement("div",{className:E([function(e){return Object(i.a)(e,{backgroundImage:I,display:"block",backgroundOrigin:"border-box",backgroundSize:"cover",height:_,width:P,minHeight:j,minWidth:T,backgroundPosition:k,maxWidth:"100%"})},n])})}d.defaultProps={focusPercent:[50,50]}},"./src/framework/design-system/index.ts":function(e,t,n){"use strict";var r=n("./src/framework/design-system/components/grid-system/index.ts");n.d(t,"a",(function(){return r.c}))},"./src/framework/track/IntersectionPresenter.tsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("./node_modules/@babel/runtime/helpers/slicedToArray.js"),a=n.n(r),o=n("./node_modules/react/index.js"),i=n("./src/framework/track/index.ts"),s=o.forwardRef((function(e,t){var n=e.rootMargin,r=e.children,s=o.useState(!1),c=a()(s,2),u=c[0],l=c[1],p=o.useCallback((function(e){!u&&e.isIntersecting&&l(!0)}),[u]);return Object(i.f)({onIntersect:p,target:t,disconnect:function(){return u},rootMargin:n},[u]),"function"==typeof r?o.createElement(o.Fragment,null,r(u)):u?o.createElement(o.Fragment,null,r):null}))},"./src/util/typeGuards.ts":function(e,t,n){"use strict";function r(e){return null!=e}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=AMPPost~CollectionHomepage~CollectionHomepagePreview~DebugCachedPost~PackageBuilder~Post~PostSetting~8e568ca5.88be8613.chunk.js.map