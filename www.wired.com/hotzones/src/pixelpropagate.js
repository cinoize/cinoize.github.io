var beaconHostname='infinityid.condenastdigital.com';function setOptions(cookie,options){var arr=cookie;arr.push('expires='+options.expires);arr.push('path='+options.path);arr=options.domain?arr.push('domain='+options.domain)&&arr:arr;arr=options.secure?arr.push('secure')&&arr:arr;return arr;}var cookie={get:function get(name){var cookies=document.cookie.split('; ');var cookie=[];for(var c=0;c<cookies.length;c++){cookie=cookies[c].split('=');if(cookie[0]===name){return decodeURIComponent(cookie[1]);}}return false;},set:function set(name,cValue,cOptions){if(!name){return undefined;}var options=cOptions||{};var value=cValue||true;var doEncode=!!options.encode||true;var cookieValue=doEncode?encodeURIComponent(value):value;var str=name+'='+cookieValue;var cookie=[str];options.path=options.path||'/';options.expires=new Date(+new Date()+options.expires*3600000);cookie=setOptions(cookie,options);document.cookie=cookie.join('; ');return str;},};function ajax(opts){return new Promise(function xhrPromise(resolve,reject){var xhr=new XMLHttpRequest();xhr.open('GET',opts.URL);xhr.withCredentials=opts.cors||false;xhr.onreadystatechange=function onStateChange(){if(this.readyState===4){if(this.status>=200&&this.status<300){resolve(this.responseText);}else{reject(new Error(this));}}};xhr.send();});}function resetOurXid(){return ajax({URL:'//infinityid.condenastdigital.com/?rand='+Date.now(),cors:true,}).then(function resetXid(newXid){if(newXid){cookie.set('CN_xid',newXid,{path:'/',expires:4320,});}return newXid;}).catch(function catchError(err){console.log('error resetting xid',err);});}function propagateXid(hostname){var xid=cookie.get('CN_xid');if(!xid||window.location.hostname===hostname){return false;}return new Promise(function checker(resolve,reject){var beacon=new Image();beacon.onerror=function beaconErr(beaconError){console.warn('[ hotzones ads plugin 4d ] XID not propagated for ',hostname,beaconError);if(hostname===beaconHostname){resetOurXid().then(function resetResult(newXid){resolve(newXid);});return;}reject();};beacon.onload=function beaconDone(){resolve();};beacon.src='https://'+hostname+'/infinityid/beacon?id='+encodeURIComponent(xid);});}function pixel(conf){if(!cookie.get('xid1')){return;}var propagateHosts=['www.allure.com','www.architecturaldigest.com','www.bonappetit.com','www.cntraveler.com','www.epicurious.com','www.glamour.com','www.gq.com','www.lennyletter.com','www.newyorker.com','pitchfork.com','www.self.com','www.teenvogue.com','www.them.us','www.vanityfair.com','www.vogue.com','www.wired.com',];function pixelLoadHosts(){propagateHosts.forEach(function sendXid(hostname){propagateXid(hostname);});}function pixelLoad(){var canBeacon=propagateXid(beaconHostname);if(canBeacon){canBeacon.then(pixelLoadHosts);}}var ready=document.readyState;if(document.attachEvent?ready==='complete':ready!=='loading'){pixelLoad();}else{document.addEventListener('DOMContentLoaded',pixelLoad);}}if(window.cns&&window.cns.config&&window.cns.config.plugins['4d'].xid_pixels){pixel();}
